<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Seismic Dashboard (USGS + CSV)</title>
    <link rel="stylesheet" href="styles.css" />

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;600;700&family=IBM+Plex+Mono:wght@400;600&display=swap"
      rel="stylesheet"
    />

    <!-- Libraries (CDN). If your environment is offline, see README.md for options. -->
    <script src="https://cdn.jsdelivr.net/npm/papaparse@5.4.1/papaparse.min.js"></script>
    <script src="https://cdn.plot.ly/plotly-2.30.0.min.js"></script>
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
      crossorigin=""
    />
    <script
      src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
      integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
      crossorigin=""
    ></script>
  </head>
  <body>
    <div class="bg-grid" aria-hidden="true"></div>

    <header class="header">
      <div class="header__left">
        <div class="kicker">Dashboard</div>
        <h1>Myanmar Seismic Hub</h1>
        <p class="subhead">
          Fetch earthquakes from USGS or upload a CSV from the USGS search page.
        </p>
      </div>

      <div class="header__right">
        <div class="filebox">
          <div class="filebox__label">Local CSV</div>
          <div class="filebox__row">
            <button id="btnLoad" class="btn btn--primary" type="button">
              Load sample (query.csv)
            </button>
            <label class="btn btn--ghost" for="fileInput">Upload CSV</label>
            <input id="fileInput" type="file" accept=".csv,text/csv" />
          </div>
          <div id="dataStatus" class="muted">No data loaded yet.</div>
        </div>
      </div>
    </header>

    <main class="main">
      <section class="panel panel--usgs" aria-label="USGS download">
        <div class="panel__title">USGS data download</div>
        <div class="filters__row">
          <div class="field">
            <label for="usgsStart">Start date (UTC)</label>
            <input id="usgsStart" type="date" />
          </div>
          <div class="field">
            <label for="usgsEnd">End date (UTC)</label>
            <input id="usgsEnd" type="date" />
          </div>
          <div class="field">
            <label for="usgsMinMag">Min mag</label>
            <input id="usgsMinMag" type="number" step="0.1" inputmode="decimal" />
          </div>
          <div class="field">
            <label for="usgsMaxMag">Max mag</label>
            <input id="usgsMaxMag" type="number" step="0.1" inputmode="decimal" />
          </div>
          <div class="field">
            <label for="usgsMinDepth">Min depth (km)</label>
            <input id="usgsMinDepth" type="number" step="1" inputmode="numeric" />
          </div>
          <div class="field">
            <label for="usgsMaxDepth">Max depth (km)</label>
            <input id="usgsMaxDepth" type="number" step="1" inputmode="numeric" />
          </div>
        </div>
        <div class="filters__row">
          <div class="field field--actions">
            <label>&nbsp;</label>
            <div class="actions">
              <button id="usgsFetch" class="btn btn--primary" type="button">
                Fetch &amp; Load
              </button>
              <button id="usgsDownload" class="btn btn--ghost" type="button">
                Download CSV
              </button>
              <a
                id="usgsOpen"
                class="btn btn--ghost"
                href="https://earthquake.usgs.gov/earthquakes/search/"
                target="_blank"
                rel="noopener"
              >
                Open USGS Search
              </a>
            </div>
          </div>
          <div class="field field--checkbox">
            <label for="usgsMyanmarOnly">Myanmar only</label>
            <label class="checkbox">
              <input id="usgsMyanmarOnly" type="checkbox" />
              <span>Restrict USGS query</span>
            </label>
          </div>
          <div class="usgs__note muted">
            Dates are interpreted in UTC; large ranges may take longer to download.
          </div>
        </div>
        <div id="usgsStatus" class="muted">Ready.</div>
      </section>

      <section class="panel panel--kpis" aria-label="Key metrics">
        <div class="kpi">
          <div class="kpi__label">Events</div>
          <div id="kpiEvents" class="kpi__value mono">-</div>
          <div id="kpiEventsSub" class="kpi__sub muted">-</div>
        </div>
        <div class="kpi">
          <div class="kpi__label">Max magnitude</div>
          <div id="kpiMaxMag" class="kpi__value mono">-</div>
          <div id="kpiMaxMagSub" class="kpi__sub muted">-</div>
        </div>
        <div class="kpi">
          <div class="kpi__label">Deepest (km)</div>
          <div id="kpiDeepest" class="kpi__value mono">-</div>
          <div id="kpiDeepestSub" class="kpi__sub muted">-</div>
        </div>
        <div class="kpi">
          <div class="kpi__label">Date range</div>
          <div id="kpiRange" class="kpi__value mono">-</div>
          <div id="kpiRangeSub" class="kpi__sub muted">-</div>
        </div>
      </section>

      <section class="panel panel--filters" aria-label="Filters">
        <div class="filters__row">
          <div class="field">
            <label for="dateStart">Start date</label>
            <input id="dateStart" type="date" />
          </div>
          <div class="field">
            <label for="dateEnd">End date</label>
            <input id="dateEnd" type="date" />
          </div>
          <div class="field">
            <label for="magMin">Mag min</label>
            <input id="magMin" type="number" step="0.1" inputmode="decimal" />
          </div>
          <div class="field">
            <label for="magMax">Mag max</label>
            <input id="magMax" type="number" step="0.1" inputmode="decimal" />
          </div>
          <div class="field">
            <label for="depthMin">Depth min (km)</label>
            <input id="depthMin" type="number" step="1" inputmode="numeric" />
          </div>
          <div class="field">
            <label for="depthMax">Depth max (km)</label>
            <input id="depthMax" type="number" step="1" inputmode="numeric" />
          </div>
        </div>

        <div class="filters__row">
          <div class="field field--wide">
            <label for="placeSearch">Place contains</label>
            <input id="placeSearch" type="text" placeholder="e.g., India, Burma, Sagaing..." />
          </div>
          <div class="field">
            <label for="statusSel">Status</label>
            <select id="statusSel">
              <option value="all">All</option>
              <option value="reviewed">Reviewed</option>
              <option value="automatic">Automatic</option>
            </select>
          </div>
          <div class="field field--checkbox">
            <label for="myanmarOnly">Myanmar only</label>
            <label class="checkbox">
              <input id="myanmarOnly" type="checkbox" />
              <span>Filter to Myanmar</span>
            </label>
          </div>
          <div class="field">
            <label for="magTypeSel">Mag type</label>
            <select id="magTypeSel">
              <option value="all">All</option>
            </select>
          </div>
          <div class="field">
            <label for="bucketSel">Time bucket</label>
            <select id="bucketSel">
              <option value="day">Day</option>
              <option value="week">Week</option>
              <option value="month">Month</option>
            </select>
          </div>
          <div class="field field--actions">
            <label>&nbsp;</label>
            <div class="actions">
              <button id="btnReset" class="btn" type="button">Reset</button>
              <button id="btnExport" class="btn btn--ghost" type="button">Export filtered CSV</button>
            </div>
          </div>
        </div>

        <div id="filterStatus" class="muted">Load data to enable filters.</div>
      </section>

      <section class="grid">
        <div class="panel panel--chart">
          <div class="panel__title">Map</div>
          <div id="chartMap" class="chart"></div>
        </div>

        <div class="panel panel--chart">
          <div class="panel__title">Events over time</div>
          <div id="chartTime" class="chart"></div>
        </div>

        <div class="panel panel--chart">
          <div class="panel__title">Magnitude distribution</div>
          <div id="chartHist" class="chart"></div>
        </div>

        <div class="panel panel--chart">
          <div class="panel__title">Depth vs magnitude</div>
          <div id="chartScatter" class="chart"></div>
        </div>
      </section>

      <section class="panel panel--table" aria-label="Events table">
        <div class="table__head">
          <div class="panel__title">Events</div>
          <div class="muted">Top 100 (sorted by time desc)</div>
        </div>
        <div class="tablewrap">
          <table>
            <thead>
              <tr>
                <th>Time (UTC)</th>
                <th class="num">Mag</th>
                <th class="num">Depth (km)</th>
                <th>Place</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody id="eventsTbody"></tbody>
          </table>
        </div>
      </section>
    </main>

    <script src="app.js"></script>
  </body>
</html>
